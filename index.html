<!doctype html>
<html lang="en-US">
<head>
   <meta charset="utf-8">
   <meta http-equiv="X-UA-Compatible" content="IE=edge">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <link rel="stylesheet" href="css/menu.css">
   <link rel="stylesheet" href="css/split.css">
   <link rel="stylesheet" href="css/list.css">
   <script src="js/jquery-3.5.1.min.js" type="text/javascript"></script>
   <script src="js/menu.js"></script>
   <script src="js/sigma.min.js"></script>
   <script src="js/plugins/sigma.plugins.animate.min.js"></script>
   <script src="js/plugins/sigma.layout.forceAtlas2.min.js"></script>
   <script src="js/plugins/sigma.layout.noverlap.min.js"></script>
   <script src="js/plugins/sigma.parsers.gexf.min.js"></script>
   <script src="js/plugins/sigma.parsers.json.min.js"></script>
   <script src="js/plugins/sigma.exporters.svg.min.js"></script>
   <script src="js/plugins/sigma.plugins.dragNodes.min.js"></script>
   <script src="js/maiascript.js"></script>
   <title>Complex Network Analysis Tool</title>
   <style type="text/css">
      #container {
         max-width: 95%;
         height: 95%;
      }
   </style>
</head>
<body style="background-color: black;" onload="maiavm.compile();">
   <div id="cssmenu">
      <ul>
         <li><a href="http://maia.maiascript.com">Maia</a></li>
         <li><a class="active" href="#">File</a>
            <ul>
               <li><a id="#">New</a>
                  <ul>
                     <li><a id="newFile" onclick="newFile()">Blank workspace</a></li>
                     <li><a id="newComplete" onclick="newComplete()">Complete graph</a></li>
                     <li><a id="newRandom" onclick="newRandom()">Random graph</a></li>
                     <li><a id="newScaleFree" onclick="newScaleFree()">Scale-free graph</a></li>
                     <li><a id="newSmallWorld" onclick="newSmallWorld()">Small-world graph</a></li>
                     <li><a id="newHybrid" onclick="newHybrid()">Hybrid graph</a></li>
                     
                  </ul>
               </li>
               <li><a id="openFile" onclick="openFile()">Open</a></li>
               <li><a id="#">Save</a>
                  <ul>
                     <li><a id="saveFile" onclick="saveFile()">Pajek file</a></li>
                     <li><a id="saveFile" onclick="saveJsonFile()">JSON file</a></li>
                     <li><a id="saveGraph" onclick="saveGraph()">Graph file</a></li>
                     <li><a id="saveReport" onclick="saveReport()">Report file</a></li>
                  </ul>
               </li>
            </ul>
         </li>
         <li><a href="#">View</a>
            <ul>
               <li><a id="showSummary" onclick="showSummary()">Properties summary</a></li>
               <li><a id="showDegrees" onclick="showDegrees()">Vertices degrees</a></li>
               <li><a id="showClustering" onclick="showClustering()">Vertices clustering</a></li>
               <li><a id="showCentralities" onclick="showCentralities()">Vertices centralities</a></li>
            </ul>
         </li>
         <li><a href="#">Help</a>
            <ul>
               <li><a id="showAboutDialog" onclick="showAboutDialog()">About</a></li>
               <li><a href="mailto:roberto@souzamonteiro.com">Contact</a></li>
            </ul>
         </li>
      </ul>
   </div>
   <div>
      <div class="split left">
         <ul class="list">
            <li class="item"><div class="label">Vertices:</div><div id="vertices" class="value"></div></li>
            <li class="item"><div class="label">Edges:</div><div id="edges" class="value"></div></li>
            <li class="item"><div class="label">Density:</div><div id="density" class="value"></div></li>
            <li class="item"><div class="label">Avg. Degree:</div><div id="averageDegree" class="value"></div></li>
            <li class="item"><div class="label">Avg. Clustering Coef.:</div><div id="averageClusteringCoefficient" class="value"></div></li>
            <li class="item"><div class="label">Avg. Shortest Path:</div><div id="averageShortestPath" class="value"></div></li>
            <li class="item"><div class="label">Diameter:</div><div id="diameter" class="value"></div></li>
            <li class="item"><div class="label">Global Efficiency:</div><div id="globalEfficiency" class="value"></div></li>
            <li class="item">
               <label class="label" for="algorithm">Algorithm:</label>
               <select id="algorithm" name="algorithm" style="float: right;" onchange="updateGraph()">
                  <option value="none" selected="selected">None</option>
                  <option value="forceAtlas2">Force Atlas 2</option>
                  <option value="noverlap">No Overlap</option>
               </select>
            </li>
            <li class="item">
               <label class="label" for="directedGraph">Directed Graph:</label>
               <input id="directedGraph" nome="directedGraph" style="float: right;" type="checkbox" value="directed" onchange="updateProperties()"><br />
               <label class="label" for="calculateProperties">Calculate Properties:</label>
               <input id="calculateProperties" nome="calculateProperties" style="float: right;" type="checkbox" value="calculate" onchange="updateProperties()"><br />
            </li>
         </ul>
      </div>
      <div class="split right">
         <div id="container"></div>
      </div>
   </div>
   <!--
      It is only possible to load MaiaScript code using the HTTP protocol,
      as the browser does not allow reading local files.
      Then we use the compiled version of the library.
   -->
   <!-- <script type="text/maiascript" src="./maia/cna/cna.maia"></script> -->
   <script type="text/javascript" src="js/cna.js"></script>
   <script type="text/javascript">
      var graph;

      function showGraph(data) {
         sigmaConfig = { 
            graph: data,
            container: "container",
            settings: {
               autoResize: true,
               scalingMode: "inside",
               defaultNodeColor: "#ec5148"
            }
         };
         document.getElementById("container").innerHTML = "";
         graph = new sigma(sigmaConfig);

         try {
            var dragListener = sigma.plugins.dragNodes(graph, graph.renderers[0]);
         } catch (e) {
            console.log(e.message);
         }
      }

      function updateGraph() {
         algorithm = document.getElementById("algorithm");
         try {
            if (algorithm.value == "noverlap") {
               if (graph.isForceAtlas2Running()) {
                  graph.stopForceAtlas2();
               }
               var config = {
                  nodeMargin: 2.0,
                  scaleNodes: 1.0
               };
               // Configure the algorithm.
               var listener = graph.configNoverlap(config);
               // Bind all events.
               listener.bind('start stop interpolate', function(event) {
                  console.log(event.type);
               });
               // Start the algorithm.
               graph.startNoverlap();
            } else if (algorithm.value == "forceAtlas2") {
               if (graph.isNoverlapRunning()) {
                  graph.stopNoverlap();
               }
               var config = {
                  worker: true,
                  barnesHutOptimize: false
               }
               // Start the algorithm.
               graph.startForceAtlas2(config);
            } else if (algorithm.value == "random") {
               if (graph.isNoverlapRunning()) {
                  graph.stopNoverlap();
               }
               if (graph.isForceAtlas2Running()) {
                  graph.stopForceAtlas2();
               }
            } else {
               if (graph.isNoverlapRunning()) {
                  graph.stopNoverlap();
               }
               if (graph.isForceAtlas2Running()) {
                  graph.stopForceAtlas2();
               }
            }
         } catch (e) {
            console.log(e.message);
         }
      }
   </script>
   <!-- However, we can compile MaiaScript code while running the scripts on the page. -->
   <script type="text/maiascript">
      fileObject = {
         "fullFileName": "",
         "fileName": "",
         "fileExtension": "",
         "fileData": ""
      }
      
      property = {
         "n": 0,
         "m": 0,
         "directed": false
      }
      
      adj = []
      networkLabel = []
      networkDegree = []
      networkDegreeDistribution = []
      networkClustering = []
      networkShortestPath = []
      networkCentrality = []
      networkVertexEfficiency = []
      
      function updateProperties() {
         directedGraph = document.getElementById("directedGraph")

         property.directed = directedGraph.checked
         showProperties(adj, property)
      }

      function showProperties(adj, property) {
         calculateProperties = document.getElementById("calculateProperties")

         networkVertices = property.n
         networkEdges = property.m
         
         networkLabel = cna.getLabels(adj)
         networkDensity = cna.getDensity(adj, property.directed)

         vertices = document.getElementById("vertices")
         edges = document.getElementById("edges")
         density = document.getElementById("density")
         averageDegree = document.getElementById("averageDegree")
         averageClusteringCoefficient = document.getElementById("averageClusteringCoefficient")
         averageShortestPath = document.getElementById("averageShortestPath")
         diameter = document.getElementById("diameter")
         globalEfficiency = document.getElementById("globalEfficiency")
         
         vertices.innerHTML = networkVertices
         edges.innerHTML = networkEdges
         density.innerHTML = string.sprintf("%.4f", networkDensity)
         
         if (!calculateProperties.checked) {
            averageDegree.innerHTML = ""
            averageClusteringCoefficient.innerHTML = ""
            averageShortestPath.innerHTML = ""
            diameter.innerHTML = ""
            globalEfficiency.innerHTML = ""
            return()
         }

         networkDegree = cna.getDegrees(adj, property.directed)
         networkAverageDegree = cna.getAverageDegree(networkDegree)
         networkClustering = cna.getClustering(adj, property.directed)
         networkAverageClustering = cna.getAverageClustering(networkClustering)
         networkShortestPath = cna.getShortestPath(adj)
         networkAverageShortestPath = cna.getAverageShortestPath(networkShortestPath)
         networkDiameter = cna.getDiameter(networkShortestPath)
         networkVertexEfficiency = cna.getVertexEfficiency(networkShortestPath)
         networkGlobalEfficiency = cna.getGlobalEfficiency(networkVertexEfficiency)
         
         averageDegree.innerHTML = string.sprintf("%.4f", networkAverageDegree)
         averageClusteringCoefficient.innerHTML = string.sprintf("%.4f", networkAverageClustering)
         averageShortestPath.innerHTML = string.sprintf("%.4f", networkAverageShortestPath)
         diameter.innerHTML = networkDiameter
         globalEfficiency.innerHTML = string.sprintf("%.4f", networkGlobalEfficiency)
      }

      function newFile() {
         win = window.open("index.html", "", "")
      }

      function newComplete() {
         n = core.toNumber(system.showInputDialog("Number of vertices:", "0"))
         
         property = {
            "n": 0,
            "m": 0,
            "directed": false
         }
         
         adj = cna.createNetwork("complete", n)
         
         fileObject = {
            "fullFileName": "complete.net",
            "fileName": "complete",
            "fileExtension": "net",
            "fileData": cna.createPajekFile(adj, "edges")
         }
         
         fileData = cna.pajekFileToJson(fileObject.fileData, property)
         showGraph(fileData)

         directedGraph = document.getElementById("directedGraph")
         directedGraph.checked = property.directed

         showProperties(adj, property)
         
         algorithm = document.getElementById("algorithm")
         algorithm.onchange()
      }

      function newRandom() {
         n = core.toNumber(system.showInputDialog("Number of vertices:", "0"))
         m = core.toNumber(system.showInputDialog("Number of edges:", "0"))
         p = 0
         d = 0
         
         property = {
            "n": 0,
            "m": 0,
            "directed": false
         }
         
         if (m == 0) {
            p = core.toNumber(system.showInputDialog("Edge probability:", "0"))
            if (p == 0) {
               d = core.toNumber(system.showInputDialog("Average degree:", "0"))   
            }
         }

         adj = cna.createNetwork("random", n, m, p, d)
         
         fileObject = {
            "fullFileName": "random.net",
            "fileName": "random",
            "fileExtension": "net",
            "fileData": cna.createPajekFile(adj, "edges")
         }
         
         fileData = cna.pajekFileToJson(fileObject.fileData, property)
         showGraph(fileData)

         directedGraph = document.getElementById("directedGraph")
         directedGraph.checked = property.directed

         showProperties(adj, property)

         algorithm = document.getElementById("algorithm")
         algorithm.onchange()
      }

      function newScaleFree() {
         n = core.toNumber(system.showInputDialog("Number of vertices:", "0"))
         m = 0
         d = core.toNumber(system.showInputDialog("Average degree:", "0"))
         p = core.toNumber(system.showInputDialog("Edge probability:", "0"))
         
         property = {
            "n": 0,
            "m": 0,
            "directed": false
         }
         
         adj = cna.createNetwork("scalefree", n, m, p, d)
         
         fileObject = {
            "fullFileName": "scalefree.net",
            "fileName": "scalefree",
            "fileExtension": "net",
            "fileData": cna.createPajekFile(adj, "edges")
         }
         
         fileData = cna.pajekFileToJson(fileObject.fileData, property)
         showGraph(fileData)

         directedGraph = document.getElementById("directedGraph")
         directedGraph.checked = property.directed

         showProperties(adj, property)

         algorithm = document.getElementById("algorithm")
         algorithm.onchange()
      }

      function newSmallWorld() {
         n = core.toNumber(system.showInputDialog("Number of vertices:", "0"))
         m = 0
         d = core.toNumber(system.showInputDialog("Average degree:", "0"))
         p = core.toNumber(system.showInputDialog("Edge probability:", "0"))
         
         property = {
            "n": 0,
            "m": 0,
            "directed": false
         }
         
         adj = cna.createNetwork("smallworld", n, m, p, d)
         
         fileObject = {
            "fullFileName": "smallworld.net",
            "fileName": "smallworld",
            "fileExtension": "net",
            "fileData": cna.createPajekFile(adj, "edges")
         }
         
         fileData = cna.pajekFileToJson(fileObject.fileData, property)
         showGraph(fileData)

         directedGraph = document.getElementById("directedGraph")
         directedGraph.checked = property.directed

         showProperties(adj, property)

         algorithm = document.getElementById("algorithm")
         algorithm.onchange()
      }

      function newHybrid() {
         n = core.toNumber(system.showInputDialog("Number of vertices:", "0"))
         m = 0
         d = core.toNumber(system.showInputDialog("Average degree:", "0"))
         p = core.toNumber(system.showInputDialog("Edge probability:", "0"))
         
         property = {
            "n": 0,
            "m": 0,
            "directed": false
         }
         
         adj = cna.createNetwork("hybrid", n, m, p, d)
         
         fileObject = {
            "fullFileName": "hybrid.net",
            "fileName": "hybrid",
            "fileExtension": "net",
            "fileData": cna.createPajekFile(adj, "edges")
         }
         
         fileData = cna.pajekFileToJson(fileObject.fileData, property)
         showGraph(fileData)

         directedGraph = document.getElementById("directedGraph")
         directedGraph.checked = property.directed

         showProperties(adj, property)

         algorithm = document.getElementById("algorithm")
         algorithm.onchange()
      }

      function openFile() {
         function callBack(fileObject) {
            property = {
               "n": 0,
               "m": 0,
               "directed": false
            }

            if (fileObject.fileExtension == "json") {
               fileData = JSON.parse(fileObject.fileData)
               showGraph(fileData)
               network = {
                  "nodes": graph.graph.nodes(),
                  "edges": graph.graph.edges()
               }
               fileObject.fileData = cna.jsonToPajekFile(network)
               adj = cna.parsePajekFile(fileObject.fileData, property)
            } elseif (fileObject.fileExtension == "net") {
               fileData = cna.pajekFileToJson(fileObject.fileData)
               adj = cna.parsePajekFile(fileObject.fileData, property)
               showGraph(fileData)
            } else {
               system.showMessageDialog("File format not supported!")
            }
            if (core.includes(["json", "net"], fileObject.fileExtension)) {
               directedGraph = document.getElementById("directedGraph")
               directedGraph.checked = property.directed

               showProperties(adj, property)
            }
         }

         system.uploadFile(fileObject, callBack)
      }

      function saveFile() {
         network = {
            "nodes": graph.graph.nodes(),
            "edges": graph.graph.edges()
         }
         fileObject.fileData = cna.jsonToPajekFile(network)
         system.downloadFile(fileObject.fullFileName, fileObject.fileData, "text/" + fileObject.fileExtension)
      }

      function saveJsonFile() {
         fileObject.fileExtension = "json"
         fileObject.fullFileName = fileObject.fileName + "." + fileObject.fileExtension
         network = {
            "nodes": graph.graph.nodes(),
            "edges": graph.graph.edges()
         }
         fileObject.fileData = JSON.stringify(network)
         system.downloadFile(fileObject.fullFileName, fileObject.fileData, "text/" + fileObject.fileExtension)
      }

      function saveGraph() {
         svgConfig = {
            "download": true,
            "filename": fileObject.fileName + ".svg"
         }
         graph.toSVG(svgConfig)
      }

      function saveReport() {
         if (!calculateProperties.checked) {
            system.showMessageDialog("To generate this report it is necessary to check the option \"Calculate Properties\" in the properties panel.")
            return()
         }

         vertices = document.getElementById("vertices")
         edges = document.getElementById("edges")
         density = document.getElementById("density")
         averageDegree = document.getElementById("averageDegree")
         averageClusteringCoefficient = document.getElementById("averageClusteringCoefficient")
         averageShortestPath = document.getElementById("averageShortestPath")
         diameter = document.getElementById("diameter")
         globalEfficiency = document.getElementById("globalEfficiency")
         
         networkDegreeDistribution = cna.getDegreeDistribution(networkDegree)
         dimNetworkDegreeDistribution = core.dim(networkDegreeDistribution)

         html = "<!DOCTYPE html>"
         html = html + "<html lang=\"en\"><head><meta charset=\"UTF-8\"><title>Network Properties</title></head>"
         html = html + "<body>"
         html = html + "<table style=\"margin-left: auto; margin-right: auto; border: 1px solid black;\">"
         html = html + "<caption style=\"text-align: center; font-family: Arial; font-weight: bold;\">Network Properties</caption>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Vertices:</th><td style=\"text-align: right; padding: 2px;\">" + vertices.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Edges:</th><td style=\"text-align: right; padding: 2px;\">" + edges.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Density:</th><td style=\"text-align: right; padding: 2px;\">" + density.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Avg. Degree:</th><td style=\"text-align: right; padding: 2px;\">" + averageDegree.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Avg. Clustering Coef.:</th><td style=\"text-align: right; padding: 2px;\">" + averageClusteringCoefficient.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Avg. Shortest Path:</th><td style=\"text-align: right; padding: 2px;\">" + averageShortestPath.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Diameter:</th><td style=\"text-align: right; padding: 2px;\">" + diameter.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Global Efficiency:</th><td style=\"text-align: right; padding: 2px;\">" + globalEfficiency.innerHTML + "</td></tr>"
         html = html + "</table>"
         html = html + "<br />"
         html = html + "<table style=\"margin-left: auto; margin-right: auto; border: 1px solid black;\">"
         html = html + "<caption style=\"text-align: center; font-family: Arial; font-weight: bold;\">Degree Disribuion</caption>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Cluster</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Frequency</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Frequency(%)</th></tr>"
         for (i = 0; i < dimNetworkDegreeDistribution[0]; i = i + 1) {
            html = html + "<tr><td style=\"text-align: right; padding: 2px;\">" + core.toString(networkDegreeDistribution[i, 0]) + "</td><td style=\"text-align: right; padding: 2px;\">" + core.toString(networkDegreeDistribution[i, 1]) + "</td><td style=\"text-align: right; padding: 2px;\">" + string.sprintf("%.2f", networkDegreeDistribution[i, 2]) + "</td></tr>"
         }
         html = html + "</table>"
         html = html + "</body>"
         html = html + "</html>"

         system.downloadFile(fileObject.fileName + ".html", html, "text/html")
      }

      function showSummary() {
         if (!calculateProperties.checked) {
            system.showMessageDialog("To generate this report it is necessary to check the option \"Calculate Properties\" in the properties panel.")
            return()
         }

         vertices = document.getElementById("vertices")
         edges = document.getElementById("edges")
         density = document.getElementById("density")
         averageDegree = document.getElementById("averageDegree")
         averageClusteringCoefficient = document.getElementById("averageClusteringCoefficient")
         averageShortestPath = document.getElementById("averageShortestPath")
         diameter = document.getElementById("diameter")
         globalEfficiency = document.getElementById("globalEfficiency")
         
         networkDegreeDistribution = cna.getDegreeDistribution(networkDegree)
         dimNetworkDegreeDistribution = core.dim(networkDegreeDistribution)
         
         html = "<!DOCTYPE html>"
         html = html + "<html lang=\"en\"><head><meta charset=\"UTF-8\"><title>Network Properties</title></head>"
         html = html + "<body>"
         html = html + "<table style=\"margin-left: auto; margin-right: auto; border: 1px solid black;\">"
         html = html + "<caption style=\"text-align: center; font-family: Arial; font-weight: bold;\">Network Properties</caption>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Vertices:</th><td style=\"text-align: right; padding: 2px;\">" + vertices.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Edges:</th><td style=\"text-align: right; padding: 2px;\">" + edges.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Density:</th><td style=\"text-align: right; padding: 2px;\">" + density.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Avg. Degree:</th><td style=\"text-align: right; padding: 2px;\">" + averageDegree.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Avg. Clustering Coef.:</th><td style=\"text-align: right; padding: 2px;\">" + averageClusteringCoefficient.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Avg. Shortest Path:</th><td style=\"text-align: right; padding: 2px;\">" + averageShortestPath.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Diameter:</th><td style=\"text-align: right; padding: 2px;\">" + diameter.innerHTML + "</td></tr>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Global Efficiency:</th><td style=\"text-align: right; padding: 2px;\">" + globalEfficiency.innerHTML + "</td></tr>"
         html = html + "</table>"
         html = html + "<br />"
         html = html + "<table style=\"margin-left: auto; margin-right: auto; border: 1px solid black;\">"
         html = html + "<caption style=\"text-align: center; font-family: Arial; font-weight: bold;\">Degree Disribuion</caption>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Cluster</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Frequency</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Frequency(%)</th></tr>"
         for (i = 0; i < dimNetworkDegreeDistribution[0]; i = i + 1) {
            html = html + "<tr><td style=\"text-align: right; padding: 2px;\">" + core.toString(networkDegreeDistribution[i, 0]) + "</td><td style=\"text-align: right; padding: 2px;\">" + core.toString(networkDegreeDistribution[i, 1]) + "</td><td style=\"text-align: right; padding: 2px;\">" + string.sprintf("%.2f", networkDegreeDistribution[i, 2]) + "</td></tr>"
         }
         html = html + "</table>"
         html = html + "</body>"
         html = html + "</html>"
         
         win = window.open()
         iframe = win.document.createElement("iframe")
         iframe.width = "100%"
         iframe.height = "100%"
         iframe.frameBorder = 0
         iframe.style = "border: 0"
         iframe.src = "data:text/html;charset=utf-8," + html
         win.document.body.appendChild(iframe)
      }

      function showDegrees() {
         if (!calculateProperties.checked) {
            system.showMessageDialog("To generate this report it is necessary to check the option \"Calculate Properties\" in the properties panel.")
            return()
         }

         dimNetworkLabel = core.dim(networkLabel)

         html = "<!DOCTYPE html>"
         html = html + "<html lang=\"en\"><head><meta charset=\"UTF-8\"><title>Vertices Degrees</title></head>"
         html = html + "<body>"
         html = html + "<table style=\"margin-left: auto; margin-right: auto; border: 1px solid black;\">"
         html = html + "<caption style=\"text-align: center; font-family: Arial; font-weight: bold;\">Vertices Degrees</caption>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Vertex</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Out-degree</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">In-degree</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Degree</th></tr>"
         for (i = 1; i < dimNetworkLabel[0]; i = i + 1) {
            html = html + "<tr><td style=\"text-align: right; padding: 2px;\">" + networkLabel[i] + "</td><td style=\"text-align: right; padding: 2px;\">" + core.toString(networkDegree[i, 0]) + "</td><td style=\"text-align: right; padding: 2px;\">" + core.toString(networkDegree[i, 1]) + "</td><td style=\"text-align: right; padding: 2px;\">" + string.sprintf("%.4f", networkDegree[i, 2]) + "</td></tr>"
         }
         html = html + "</table>"
         html = html + "</body>"
         html = html + "</html>"
         
         win = window.open()
         iframe = win.document.createElement("iframe")
         iframe.width = "100%"
         iframe.height = "100%"
         iframe.frameBorder = 0
         iframe.style = "border: 0"
         iframe.src = "data:text/html;charset=utf-8," + html
         win.document.body.appendChild(iframe)
      }

      function showClustering() {
         if (!calculateProperties.checked) {
            system.showMessageDialog("To generate this report it is necessary to check the option \"Calculate Properties\" in the properties panel.")
            return()
         }

         dimNetworkLabel = core.dim(networkLabel)

         html = "<!DOCTYPE html>"
         html = html + "<html lang=\"en\"><head><meta charset=\"UTF-8\"><title>Vertices Clustering</title></head>"
         html = html + "<body>"
         html = html + "<table style=\"margin-left: auto; margin-right: auto; border: 1px solid black;\">"
         html = html + "<caption style=\"text-align: center; font-family: Arial; font-weight: bold;\">Vertices Clustering</caption>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Vertex</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Clustering</th></tr>"
         for (i = 1; i < dimNetworkLabel[0]; i = i + 1) {
            html = html + "<tr><td style=\"text-align: right; padding: 2px;\">" + networkLabel[i] + "</td><td style=\"text-align: right; padding: 2px;\">" + string.sprintf("%.4f", networkClustering[i, 0]) + "</td></tr>"
         }
         html = html + "</table>"
         html = html + "</body>"
         html = html + "</html>"
         
         win = window.open()
         iframe = win.document.createElement("iframe")
         iframe.width = "100%"
         iframe.height = "100%"
         iframe.frameBorder = 0
         iframe.style = "border: 0"
         iframe.src = "data:text/html;charset=utf-8," + html
         win.document.body.appendChild(iframe)
      }

      function showCentralities() {
         if (!calculateProperties.checked) {
            system.showMessageDialog("To generate this report it is necessary to check the option \"Calculate Properties\" in the properties panel.")
            return()
         }

         dimNetworkLabel = core.dim(networkLabel)

         networkCentrality = cna.getCentrality(adj, networkShortestPath, property.directed)
         
         html = "<!DOCTYPE html>"
         html = html + "<html lang=\"en\"><head><meta charset=\"UTF-8\"><title>Vertices Centralities</title></head>"
         html = html + "<body>"
         html = html + "<table style=\"margin-left: auto; margin-right: auto; border: 1px solid black;\">"
         html = html + "<caption style=\"text-align: center; font-family: Arial; font-weight: bold;\">Vertices Centralities</caption>"
         html = html + "<tr><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Vertex</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Geodesics</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Closeness</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">Betweenness</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">nCloseness</th><th style=\"text-align: left; font-family: Arial; font-weight: bold;\">nBetweenness</th></tr>"
         for (i = 1; i < dimNetworkLabel[0]; i = i + 1) {
            html = html + "<tr><td style=\"text-align: right; padding: 2px;\">" + networkLabel[i] + "</td><td style=\"text-align: right; padding: 2px;\">" + core.toString(networkCentrality[i, 4]) + "</td><td style=\"text-align: right; padding: 2px;\">" + string.sprintf("%.4f", networkCentrality[i, 0]) + "</td><td style=\"text-align: right; padding: 2px;\">" + string.sprintf("%.4f", networkCentrality[i, 1]) + "</td><td style=\"text-align: right; padding: 2px;\">" + string.sprintf("%.4f", networkCentrality[i, 2]) + "</td><td style=\"text-align: right; padding: 2px;\">" + string.sprintf("%.4f", networkCentrality[i, 3]) + "</td></tr>"
         }
         html = html + "</table>"
         html = html + "</body>"
         html = html + "</html>"
         
         win = window.open()
         iframe = win.document.createElement("iframe")
         iframe.width = "100%"
         iframe.height = "100%"
         iframe.frameBorder = 0
         iframe.style = "border: 0"
         iframe.src = "data:text/html;charset=utf-8," + html
         win.document.body.appendChild(iframe)
      }
      
      function showAboutDialog() {
         copyright = "Copyright (C) Roberto Luiz Souza Monteiro,\nRenata Souza Barreto,\nHernane Barrros de Borges Pereira.\n\nwww.maiascript.com"
         system.showMessageDialog(copyright)
      }
   </script>
</body>
<html>
